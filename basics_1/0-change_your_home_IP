#!/usr/bin/env bash
# my comment

# Backup original hosts file
cp /etc/hosts /etc/hosts.bak

# Replace localhost IP without using sed -i

# Create a temp file with the replacement for localhost line
awk '
  $1 == "127.0.0.1" && $2 == "localhost" {
    $1 = "127.0.0.2"
  }
  { print }
' /etc/hosts > /tmp/hosts.tmp

# Overwrite /etc/hosts by moving temp file
mv /tmp/hosts.tmp /etc/hosts

# Remove any existing facebook.com line
grep -v "facebook.com" /etc/hosts > /tmp/hosts.tmp && mv /tmp/hosts.tmp /etc/hosts

# Append facebook.com line
echo "8.8.8.8 facebook.com" >> /etc/hosts
